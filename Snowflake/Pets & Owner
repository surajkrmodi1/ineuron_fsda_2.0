use database demo_database;

CREATE OR REPLACE TABLE SK_OWNER
(
   OwnerID INTEGER NOT NULL PRIMARY KEY ,
   Name VARCHAR2(20),
   Surname STRING,
   StreetAddress VARCHAR2(50),
   City STRING,
   State CHAR(4),
   StateFull STRING,
   ZipCode INTEGER
);

CREATE OR REPLACE TABLE SK_PETS
(
    PetID VARCHAR(10) NOT NULL PRIMARY KEY,
    Name VARCHAR(20),
    Kind STRING,
    Gender CHAR(7),
    Age INTEGER,
    OwnerID INTEGER NOT NULL REFERENCES OWNER 
);

select * from SK_OWNER;
select * from SK_PETS;

SELECT COUNT(DISTINCT OwnerID)from SK_OWNER;

SELECT COUNT(DISTINCT PetID) from SK_PETS;


-- NEED THE NAME OF OWNER & THEIR DOGS NAME ALONG WITH THEIR AGE ---- INNER JOIN

SELECT O.Name AS OWNER_NAME,p.NAME AS PET_NAME,p.age AS PET_AGE

FROM SK_OWNER o

INNER JOIN SK_PETS p ON o.OwnerID = p.OwnerID;

--NEED THE NAME OF ALL THE OWNERS IRRESPECTIVE WETHER OR NOT THEY ARE HAVING PETS

SELECT O.Name AS OWNER_NAME,p.NAME AS PET_NAME,p.age AS PET_AGE

FROM SK_OWNER o

LEFT OUTER JOIN SK_PETS p ON o.OwnerID = p.OwnerID;

--- COUNT OF PETS EACH OWNER HAS

SELECT O.Name AS OWNER_NAME,COUNT(DISTINCT p.PETID)

FROM SK_OWNER o

INNER JOIN SK_PETS p ON o.OwnerID = p.OwnerID

GROUP BY 1

ORDER BY 2 DESC;
